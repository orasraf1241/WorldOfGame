pipeline {
    agent any
    stages {
            stage('GIt checkout') {
                steps {
                    git branch: 'master',
                    credentialsId: 'orasraf1241',
                    url: 'https://github.com/orasraf1241/WorldOfGame.git'
                }
            }

            stage('building docker file ') {
                steps {
                    sh 'sudo docker build . -t world_of_game'
                }
            }

            stage('Run docker image') {
                agent {
                    docker  {
                        image 'world_of_game'
                        reuseNode true
                    }
                }
                steps {
                    sh 'docker run --name docker-game -d -t -p 8777:80 world_of_game'
                }
            }
            stage ('Test') {
                steps {
                sh 'docker exec -t -d docker-game python /MainScores.py'
                sh 'docker exec -t -d docker-game python /tests/e2e.py'                }
            }
        }
    }


